--- a/source/perturbations.c
+++ b/source/perturbations.c
@@
-/* FDM + Quintessence - Silvio A. Corrêa Junior */
-/* Added two scalar fields: Psi (FDM) and phi (quintessence) */
-
-/* In perturbations_init(): add new species */
-if (ppt->has_fdm == _TRUE_) {
- class_call(perturbations_add_scalar_field(ppr, pba, ppt, pvec, index_pt, "Psi"),
- ppt->error_message, ppt->error_message);
-}
-if (ppt->has_quintessence == _TRUE_) {
- class_call(perturbations_add_scalar_field(ppr, pba, ppt, pvec, index_pt, "Psi"),
- ppt->error_message, ppt->error_message);
-}
-
-/* In perturbations_derivs(): add KG equations */
-if (ppt->has_fdm == _TRUE_) {
- double m2_a2 = pow(pba->a_today,2) * pow(ppt->m_Psi,2);
- y[index_pt_delta_Psi]' = -y[index_pt_theta_Psi] - 0.5 * y[index_pt_h_prime] * y[index_pt_Psi];
- y[index_pt_theta_Psi]' = -pba->H0 * pba->a_today / pba->a * y[index_pt_theta_Psi]
- + k*k * y[index_pt_delta_Psi]
- - m2_a2 * y[index_pt_delta_Psi];
-}
-
-if (ppt->has_quintessence == _TRUE_) {
- double Vpp = -pow(ppt->M_quint,4)/pow(ppt->f_quint,2) * cos(y[index_pt_phi]/ppt->f_quint);
- double m2_eff = pow(pba->a_today,2) * Vpp;
- y[index_pt_delta_phi]' = -y[index_pt_theta_phi] - 0.5 * y[index_pt_h_prime] * y[index_pt_phi_prime];
- y[index_pt_theta_phi]' = -pba->H0 * pba->a_today / pba->a * y[index_pt_theta_phi]
- + k*k * y[index_pt_delta_phi]
- - m2_eff * y[index_pt_delta_phi];
-}
+/* FDM + Quintessence - Silvio A. Corrêa Junior */
+/* Added two scalar fields: Psi (FDM) and phi (quintessence) */
+
+/* In perturbations_init(): add new species */
+if (ppt->has_fdm == _TRUE_) {
+  class_call(perturbations_add_scalar_field(ppr, pba, ppt, pvec, index_pt, "Psi"),
+             ppt->error_message, ppt->error_message);
+}
+if (ppt->has_quintessence == _TRUE_) {
+  class_call(perturbations_add_scalar_field(ppr, pba, ppt, pvec, index_pt, "phi"),  /* ← CORRIGIDO: era "Psi" */
+             ppt->error_message, ppt->error_message);
+}
+
+/* In perturbations_derivs(): add KG equations */
+if (ppt->has_fdm == _TRUE_) {
+  double m2_a2 = pba->a_today * pba->a_today * ppt->m_Psi * ppt->m_Psi;
+
+  /* δΨ' = -θ_Ψ + (1/2) h' δΨ */
+  y[index_pt_delta_Psi]' = -y[index_pt_theta_Psi] 
+                         + 0.5 * y[index_pt_h_prime] * y[index_pt_delta_Psi];  /* ← SINAL + e δΨ */
+
+  /* θ_Ψ' = -ℋ θ_Ψ + k² δΨ - m² a² δΨ */
+  y[index_pt_theta_Psi]' = -(pba->H0 * pba->a_today / pba->a) * y[index_pt_theta_Psi]
+                         + k*k * y[index_pt_delta_Psi]
+                         - m2_a2 * y[index_pt_delta_Psi];
+}
+
+if (ppt->has_quintessence == _TRUE_) {
+  /* V(ϕ) = M⁴ [1 + cos(ϕ/f)] → V''(ϕ) = - (M⁴ / f²) cos(ϕ/f) */
+  double Vpp = -pow(ppt->M_quint, 4) / pow(ppt->f_quint, 2) * cos(y[index_pt_phi] / ppt->f_quint);
+  double m2_eff = pba->a_today * pba->a_today * Vpp;
+
+  /* δϕ' = -θ_ϕ + (1/2) h' δϕ */
+  y[index_pt_delta_phi]' = -y[index_pt_theta_phi] 
+                         + 0.5 * y[index_pt_h_prime] * y[index_pt_delta_phi];  /* ← δϕ, sinal + */
+
+  /* θ_ϕ' = -ℋ θ_ϕ + k² δϕ - m_eff² δϕ */
+  y[index_pt_theta_phi]' = -(pba->H0 * pba->a_today / pba->a) * y[index_pt_theta_phi]
+                         + k*k * y[index_pt_delta_phi]
+                         - m2_eff * y[index_pt_delta_phi];
+}
