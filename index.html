<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FDM + Quintessence in CLASS — Silvio A. Corrêa Junior</title>
  <meta name="description" content="Implementação CLASS: Fuzzy Dark Matter + Axion-like Quintessence. Reprodutível — S8 reduzido. Código aberto, patch e .ini de benchmark no GitHub." />
  <meta name="author" content="Silvio A. Corrêa Junior" />
  <!-- Open Graph / Social -->
  <meta property="og:title" content="FDM + Quintessence in CLASS — Silvio A. Corrêa Junior" />
  <meta property="og:description" content="Implementação CLASS: Fuzzy Dark Matter + Axion-like Quintessence. Reprodutível — S8 reduzido. Código aberto no GitHub." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://talksilviojr.github.io/fdm-quintessence-class/" />
  <meta property="og:image" content="https://talksilviojr.github.io/fdm-quintessence-class/preview.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Fonts + Plotly + MathJax -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root{
      --bg: #060617;
      --card: rgba(18,23,40,0.8);
      --accent: linear-gradient(135deg,#00d4ff,#7c3aed);
      --primary: #00d4ff;
      --muted: #93a0b8;
      --text: #e6eef8;
      --success: #10b981;
      --glass-border: rgba(0,212,255,0.12);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:'Inter',sans-serif;
      background: radial-gradient(ellipse at 10% 20%, rgba(124,58,237,0.06), transparent 15%),
                  radial-gradient(ellipse at 80% 80%, rgba(0,212,255,0.04), transparent 12%),
                  var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.5;
      min-height:100vh;
    }
    .container{max-width:1180px;margin:2.5rem auto;padding:1rem}
    header{display:grid;grid-template-columns:1fr 360px;gap:2rem;align-items:center;margin-bottom:1.5rem}
    @media(max-width:900px){header{grid-template-columns:1fr;}}
    .title{
      font-size:2.4rem;font-weight:700;line-height:1.05;
      background:var(--accent); -webkit-background-clip:text; background-clip:text; color:transparent;
    }
    .subtitle{color:var(--muted);margin-top:0.5rem}
    .card{
      background:var(--card);
      border-radius:14px;padding:1.2rem;border:1px solid var(--glass-border);
      box-shadow:0 10px 30px rgba(2,6,23,0.6)
    }
    .metrics{display:flex;gap:1rem;flex-wrap:wrap;align-items:center;justify-content:flex-end}
    .metric{min-width:110px;text-align:center;padding:0.6rem 0;border-radius:10px}
    .metric .val{font-family:'JetBrains Mono',monospace;font-size:1.6rem;color:var(--success);font-weight:700}
    .metric .lbl{color:var(--muted);font-size:0.85rem}
    nav{display:flex;gap:0.6rem;align-items:center;flex-wrap:wrap;margin-bottom:1rem}
    .nav a{color:var(--muted);text-decoration:none;padding:0.45rem 0.9rem;border-radius:999px;font-weight:600}
    .nav a:hover{color:var(--primary);background:rgba(0,212,255,0.04)}
    main{display:grid;grid-template-columns:1fr 340px;gap:1.2rem}
    @media(max-width:1000px){main{grid-template-columns:1fr}}
    .section{margin-bottom:1rem}
    h2{color:var(--primary);font-size:1.25rem;margin-bottom:0.75rem}
    p{color:#dce8ff}
    pre{background:rgba(0,0,0,0.35);padding:0.8rem;border-radius:8px;color:#a8b7ff;font-family:'JetBrains Mono',monospace;overflow:auto}
    .plot-card{padding:1rem;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));border:1px solid var(--glass-border)}
    label{display:block;color:var(--muted);font-size:0.9rem;margin-bottom:0.25rem}
    input[type=range]{width:100%}
    .param{margin-bottom:0.9rem}
    .btn{display:inline-block;padding:0.6rem 1rem;border-radius:999px;background:linear-gradient(90deg,#00d4ff,#7c3aed);color:#041122;font-weight:700;text-decoration:none}
    footer{margin-top:2rem;padding:1.2rem;text-align:center;color:var(--muted);font-size:0.95rem}
    .badge{display:inline-block;padding:0.35rem 0.7rem;border-radius:999px;background:rgba(0,212,255,0.06);color:var(--primary);border:1px solid rgba(0,212,255,0.06);font-weight:600;margin-right:0.5rem}
    .left-col{display:flex;flex-direction:column;gap:1rem}
    .meta-row{display:flex;gap:0.6rem;flex-wrap:wrap;margin-top:0.6rem}
    .code-block{background:rgba(0,0,0,0.45);padding:0.8rem;border-radius:8px;border:1px solid rgba(255,255,255,0.02);color:#b8caff;font-family:'JetBrains Mono',monospace}
    .download-links a{display:inline-block;margin-right:0.6rem;margin-top:0.6rem}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <div class="title">FDM + Quintessence <span style="font-size:0.6em;color:#9fb6d8;">— implementação CLASS (patch)</span></div>
        <div class="subtitle">Modelo unificado do setor escuro: Fuzzy Dark Matter (ultra-leve) + Quintessência axion-like. Reprodutível — código aberto.</div>
        <div class="meta-row">
          <span class="badge">Código Aberto</span>
          <span class="badge">MIT</span>
          <span class="badge">S8 ≈ 0.79</span>
          <span class="badge">JMP Submissão</span>
        </div>

        <div style="margin-top:1rem" class="card">
          <p style="margin-bottom:0.6rem"><strong>Resumo rápido</strong>: patch para o CLASS que adiciona duas espécies escalares (Ψ e φ). Fornece outputs reprodutíveis: P(k), σ₈, S₈ e w(a).</p>
          <div style="display:flex;gap:1rem;align-items:center;justify-content:space-between;margin-top:0.8rem">
            <div style="display:flex;gap:0.8rem;align-items:center">
              <div class="metric"><div class="val" id="S8-val">0.792</div><div class="lbl">S₈ (demo)</div></div>
              <div class="metric"><div class="val" id="w0-val">-0.918</div><div class="lbl">w₀ (demo)</div></div>
              <div class="metric"><div class="val" id="time-val">—</div><div class="lbl">Run time</div></div>
            </div>
            <div style="text-align:right">
              <a class="btn" href="https://github.com/talksilviojr/fdm-quintessence-class" target="_blank" rel="noopener">GitHub / Código</a>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <strong>Downloads</strong>
        <div class="download-links" style="margin-top:0.6rem">
          <a class="btn" href="https://github.com/talksilviojr/fdm-quintessence-class/raw/main/modifications/class_fdm_quintessence.patch" target="_blank" rel="noopener">Patch (.patch)</a>
          <a class="btn" href="https://github.com/talksilviojr/fdm-quintessence-class/raw/main/modifications/explanatory" target="_blank" rel="noopener">explanatory (ini)</a>
          <a class="btn" href="https://github.com/talksilviojr/fdm-quintessence-class" target="_blank" rel="noopener">Repositório</a>
        </div>
        <div style="margin-top:0.9rem;font-size:0.92rem;color:var(--muted)">
          <strong>Citação rápida (BibTeX)</strong>
          <pre class="code-block">@misc{correa2025fdmq,
  author = {Silvio A. Corr\^{e}a Junior},
  title = {Dynamical Dark Sector: FDM + Quintessence (CLASS patch)},
  year = {2025},
  howpublished = {GitHub: talksilviojr/fdm-quintessence-class},
  url = {https://talksilviojr.github.io/fdm-quintessence-class/}
}</pre>
        </div>
      </div>
    </header>

    <nav class="nav">
      <a href="#overview">Visão Geral</a>
      <a href="#interactive">Interativo</a>
      <a href="#install">Instalação</a>
      <a href="#run">Executar</a>
      <a href="#results">Resultados</a>
      <a href="#paper">Paper</a>
    </nav>

    <main>
      <div class="left-col">

        <section id="overview" class="section card">
          <h2>Visão Geral</h2>
          <p>Este projeto implementa no CLASS duas espécies escalares minimamente acopladas: <strong>Ψ</strong> (FDM — massa ultraleve) e <strong>φ</strong> (quintessência com potencial axion-like). O patch inclui background + perturbações no gauge síncrono, documentação e exemplos de .ini.</p>
          <p style="margin-top:0.6rem;color:var(--muted)"><strong>Observáveis já gerados:</strong> P(k) z=0, σ₈, S₈, w(a), Cℓ (TT, EE), lensing.</p>
        </section>

        <section id="interactive" class="section card">
          <h2>Interativo — Explorador rápido de parâmetros</h2>
          <p style="margin-bottom:0.8rem;color:var(--muted)">Este mini-explorador usa uma aproximação toy (para visualização rápida). Para resultados exatos, execute o CLASS patchado no seu ambiente (links acima).</p>

          <div class="plot-card">
            <div id="plot-s8" style="height:360px;"></div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:0.8rem;margin-top:0.9rem">
              <div>
                <label>m<sub>Ψ</sub> (log₁₀ eV): <span id="mpsi-label">-22</span></label>
                <input id="mpsi" type="range" min="-24" max="-20" value="-22" step="0.1">
              </div>
              <div>
                <label>f<sub>quint</sub> (M<sub>pl</sub>): <span id="f-label">1.0</span></label>
                <input id="fquint" type="range" min="0.1" max="10" value="1.0" step="0.1">
              </div>
              <div>
                <label>M<sub>quint</sub> (10⁻³ eV units): <span id="M-label">2.5</span></label>
                <input id="Mquint" type="range" min="0.5" max="6.0" value="2.5" step="0.1">
              </div>
              <div>
                <label>φ<sub>ini</sub> / f : <span id="phi-label">π - 1e-5</span></label>
                <input id="phiini" type="range" min="0" max="3.1415" value="3.14158" step="0.0001">
              </div>
            </div>

            <div style="display:flex;gap:1rem;margin-top:0.9rem;align-items:center;justify-content:space-between">
              <div style="color:var(--muted)">Modelo toy: supressão aproximada da potência por FDM → impacto em σ₈ (visualização).</div>
              <div style="text-align:right">
                <a id="run-class-btn" class="btn" href="https://github.com/talksilviojr/fdm-quintessence-class" target="_blank" rel="noopener">Executar no CLASS</a>
              </div>
            </div>
          </div>
        </section>

        <section id="install" class="section card">
          <h2>Instalação</h2>
          <p>Passos rápidos — execute em um sistema com gcc/clang e make:</p>
          <pre class="code-block">git clone https://github.com/lesgourg/class_public.git class_fdmq
cd class_fdmq
git clone https://github.com/talksilviojr/fdm-quintessence-class.git modifications
patch -p1 < modifications/class_fdm_quintessence.patch
make</pre>
          <p style="color:var(--muted)">Verifique o arquivo <code>modifications/explanatory</code> para nomes de parâmetros e unidades exatas.</p>
        </section>

        <section id="run" class="section card">
          <h2>Como executar</h2>
          <p>Exemplo de .ini (já incluso no repositório). Executar:</p>
          <pre class="code-block">./class fdm_quint_benchmark.ini &gt; run.log</pre>
          <p style="color:var(--muted)">No final de <code>run.log</code> procure as linhas com <code>sigma8</code> e/ou <code>S8</code>. Se o seu build não imprimir S8 diretamente, baixe <code>output/pk.dat</code> e calcule σ₈ com o script <code>tools/calc_sigma8.py</code> (fornecido).</p>
        </section>

        <section id="results" class="section card">
          <h2>Resultados (exemplo)</h2>
          <p style="color:var(--muted)">Benchmark apresentado no artigo:</p>
          <pre class="code-block">m_Psi = 1e-22 eV
f_quint = M_pl
M_quint = 2.5e-3 eV
phi_ini ≈ π f - 1e-5 f

Resultados (benchmark):
S8 ≈ 0.792
w0 ≈ -0.918
</pre>
          <p style="color:var(--muted)">Para reproduzir exatamente os números, rode o .ini de benchmark incluído no repositório.</p>
        </section>

      </div>

      <aside class="card">
        <div style="margin-bottom:1rem">
          <h2>Paper & documentação</h2>
          <p style="color:var(--muted)">Artigo principal e documentação técnica:</p>
          <p style="margin-top:0.5rem"><a class="btn" href="https://doi.org/10.5281/zenodo.17566560" target="_blank" rel="noopener">DOI / Paper</a></p>
        </div>

        <div style="margin-top:0.6rem">
          <h2>Sobre</h2>
          <p style="color:var(--muted)">Autor: <strong>Silvio A. Corrêa Junior</strong><br>Contato: veja GitHub</p>
        </div>

        <div style="margin-top:0.6rem">
          <h2>Notas técnicas</h2>
          <ul style="color:var(--muted);margin-top:0.4rem">
            <li>Implementação: background + perturbações no gauge síncrono.</li>
            <li>Unidades: m_Psi em eV; f_quint e M_quint em unidades definidas no explanatory.</li>
            <li>Compatibilidade: branch clássica do CLASS (ver README).</li>
          </ul>
        </div>
      </aside>
    </main>

    <footer>
      © 2025 Silvio A. Corrêa Junior — <span style="color:var(--muted)">FDM + Quintessence in CLASS</span>
    </footer>
  </div>

  <script>
    // ------- Utility toy-model functions (visual only) -------
    // This is a visualization-only approximation. For exact results run CLASS with the provided patch.
    function log10(x){return Math.log(x)/Math.LN10}
    function pow10(x){return Math.pow(10,x)}

    // Toy mapping: map mPsi (eV) -> characteristic k_cut (h/Mpc)
    // These coefficients are illustrative: the real mapping must be computed with CLASS.
    function mpsi_to_khalf(mpsi_eV){
      // heuristic: lighter mass -> more suppression at larger scales (smaller k_half)
      // choose mapping so m=1e-22 -> k_half ~ 1.0 h/Mpc (tunable)
      const refM = 1e-22;
      const refK = 1.0;
      const slope = 0.6;
      let ratio = mpsi_eV / refM;
      return refK * Math.pow(ratio, slope);
    }

    // Toy S(k) suppression (FDM-like)
    function suppression(k, khalf, beta=4.0){
      return 1.0 / (1.0 + Math.pow(k / khalf, beta));
    }

    // Toy power spectrum: P(k) ~ k^ns * exp(-k/kturn)
    function toy_P(k, ns=0.965, kturn=0.2){
      return Math.pow(k, ns) * Math.exp(-k / kturn);
    }

    // Compute sigma8 by numeric integration (approx)
    function compute_sigma8_from_P(karr, Parr){
      // sigma^2 = 1/(2pi^2) ∫ k^2 P(k) W(kR)^2 dk, R=8 Mpc/h
      const R = 8.0;
      const two_pi2 = 2.0 * Math.PI * Math.PI;
      function W(kR){
        if (kR < 1e-6) return 1.0;
        return 3.0 * (Math.sin(kR) - kR * Math.cos(kR)) / Math.pow(kR, 3);
      }
      // trapezoid integration
      let integr = 0.0;
      for (let i=0;i<karr.length-1;i++){
        const k1 = karr[i], k2 = karr[i+1];
        const pk1 = Parr[i], pk2 = Parr[i+1];
        const mid1 = k1*k1*pk1*Math.pow(W(k1*R),2);
        const mid2 = k2*k2*pk2*Math.pow(W(k2*R),2);
        integr += 0.5*(mid1+mid2)*(k2-k1);
      }
      return Math.sqrt(integr / two_pi2);
    }

    // Build k grid and base P(k)
    const kgrid = [];
    for (let i=0;i<1200;i++){
      let val = Math.pow(10, -4 + (i/1199)*(4)); // 1e-4 .. 1e0? expand to 1e0.. but good enough
      kgrid.push(val);
    }

    // initial rendering
    const mpsiEl = document.getElementById('mpsi');
    const fEl = document.getElementById('fquint');
    const MEl = document.getElementById('Mquint');
    const phiEl = document.getElementById('phiini');

    const mpsiLabel = document.getElementById('mpsi-label');
    const fLabel = document.getElementById('f-label');
    const MLabel = document.getElementById('M-label');
    const phiLabel = document.getElementById('phi-label');
    const S8ValEl = document.getElementById('S8-val');
    const w0ValEl = document.getElementById('w0-val');
    const timeValEl = document.getElementById('time-val');

    function recomputeAndPlot(){
      const logm = parseFloat(mpsiEl.value); // e.g. -22
      const mpsi = Math.pow(10, logm);
      const fval = parseFloat(fEl.value);
      const Mval = parseFloat(MEl.value);
      const phiini = parseFloat(phiEl.value);

      mpsiLabel.textContent = logm;
      fLabel.textContent = fval.toFixed(2);
      MLabel.textContent = Mval.toFixed(2);
      phiLabel.textContent = phiini.toFixed(5);

      // toy mapping to S8 and w0
      const khalf = mpsi_to_khalf(mpsi);
      // build suppressed P(k)
      const Pbase = kgrid.map(k => toy_P(k));
      const Pfdm = kgrid.map((k, i) => Pbase[i] * suppression(k, khalf, 4.0));

      // compute sigma8 for LCDM approximation and FDM toy
      // normalize base P to sigma8_planck ~ 0.811 (approx)
      const sigma8_planck = 0.811;
      const s8_base = compute_sigma8_from_P(kgrid, Pbase);
      const A_norm = Math.pow(sigma8_planck / s8_base, 2);
      const Pnorm = Pbase.map(p => p * A_norm);
      const Pnorm_fdm = Pfdm.map(p => p * A_norm);

      const sigma8_lcdm = compute_sigma8_from_P(kgrid, Pnorm);
      const sigma8_fdm = compute_sigma8_from_P(kgrid, Pnorm_fdm);

      // toy w0: function of f_quint and initial displacement
      // flatter potential (larger f) -> w0 closer to -1; small displacement -> closer to -1
      const delta = Math.abs(Math.PI - phiini);
      // simple heuristic:
      const w0 = -1 + (0.1) * (1.0 / Math.max(0.1, fval)) * (Math.min(1.0, delta*1e2));
      const S8 = sigma8_fdm * Math.sqrt(0.31 / 0.3);

      // update metrics in UI
      S8ValEl.textContent = S8.toFixed(3);
      w0ValEl.textContent = w0.toFixed(3);
      timeValEl.textContent = "~ demo";

      // Plotly plot: S8 vs mpsi line (we redraw local curve for current point)
      const mpts = [-24,-23.5,-23,-22.5,-22,-21.5,-21,-20.5,-20];
      const svals = mpts.map(lm => {
        const m = Math.pow(10,lm);
        const khalfLocal = mpsi_to_khalf(m);
        const PfdmLocal = kgrid.map((k,i)=>Pbase[i] * suppression(k,khalfLocal,4.0) * A_norm);
        const s8 = compute_sigma8_from_P(kgrid,PfdmLocal) * Math.sqrt(0.31/0.3);
        return s8;
      });

      const trace1 = { x: mpts.map(x=>Math.pow(10,x)), y: svals, name: 'FDM+Q (toy)', mode:'lines+markers', line:{color:'#00d4ff'} };
      const trace2 = { x: mpts.map(x=>Math.pow(10,x)), y: mpts.map(_=>0.832), name: 'ΛCDM (ref)', mode:'lines', line:{color:'#ff6b6b',dash:'dash'} };
      const currentTrace = { x: [Math.pow(10,logm)], y: [S8], name:'ponto atual', mode:'markers', marker:{size:12,color:'#7c3aed'} };

      const layout = {
        title: {text:'S₈ vs m_Ψ (visualização rápida)', font:{color:'#cfeaff'}},
        xaxis:{type:'log',title:'m_Ψ [eV]',tickformat:'.0e',color:'#94a3b8'},
        yaxis:{title:'S₈',range:[0.76,0.84],color:'#94a3b8'},
        paper_bgcolor:'rgba(0,0,0,0)',
        plot_bgcolor:'rgba(0,0,0,0)',
        font:{color:'#94a3b8'}
      };

      Plotly.react('plot-s8', [trace2, trace1, currentTrace], layout, {responsive:true});
    }

    // initial
    recomputeAndPlot();

    // attach events
    [mpsiEl,fEl,MEl,phiEl].forEach(el => el.addEventListener('input', recomputeAndPlot));
  </script>
</body>
</html>
